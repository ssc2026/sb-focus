<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SSC26 Premium Preparation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');
        :root { --primary: #38bdf8; --primary-glow: rgba(56, 189, 248, 0.4); --bg-dark: #020617; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: var(--bg-dark); color: #f1f5f9; background-image: radial-gradient(circle at 50% -20%, #1e293b 0%, #020617 80%); min-height: 100vh; margin: 0; padding: 0; overflow-x: hidden; }
        .glass-card { background: rgba(15, 23, 42, 0.6); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.05); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); border-radius: 1.5rem; }
        .premium-border { position: relative; background: linear-gradient(var(--bg-dark), var(--bg-dark)) padding-box, linear-gradient(to right, #38bdf8, #818cf8) border-box; border: 1px solid transparent; }
        .nav-active { color: var(--primary) !important; text-shadow: 0 0 15px var(--primary-glow); }
        .page-section { display: none; }
        .page-section.active { display: block; animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .bottom-nav-container { position: fixed; bottom: 24px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; z-index: 9999; pointer-events: auto !important; }
        .nav-btn { pointer-events: auto !important; cursor: pointer; -webkit-tap-highlight-color: transparent; }
        .modal-overlay { background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(10px); position: fixed; inset: 0; z-index: 10001; display: flex; align-items: center; justify-content: center; padding: 20px; }
    </style>
</head>
<body class="pb-32">
    <audio id="click-sound" preload="auto" src="https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3"></audio>
    <audio id="end-sound" preload="auto" src="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"></audio>

    <div id="trial-modal" class="modal-overlay hidden">
        <div class="glass-card p-8 w-full max-w-sm border border-rose-500/30 text-center space-y-6">
            <div class="w-20 h-20 bg-rose-500/20 rounded-full flex items-center justify-center mx-auto animate-pulse">
                <i class="fas fa-lock text-rose-500 text-3xl"></i>
            </div>
            <div>
                <h2 class="text-2xl font-black text-white">Trial Expired</h2>
                <p class="text-slate-400 text-sm mt-2 leading-relaxed">Your 7-day premium access has ended. Please subscribe to continue using StudyPro.</p>
            </div>
            <button class="w-full py-4 bg-gradient-to-r from-rose-600 to-rose-500 rounded-2xl font-bold text-white shadow-lg shadow-rose-900/20">UPGRADE NOW</button>
            <p class="text-[10px] text-slate-600 uppercase tracking-widest">Device ID: SSC26-PRO-TEMP</p>
        </div>
    </div>

    <div id="summary-modal" class="modal-overlay hidden">
        <div class="glass-card p-8 w-full max-w-sm border border-sky-500/30 text-center space-y-4">
            <div class="w-16 h-16 bg-sky-500/20 rounded-full flex items-center justify-center mx-auto">
                <i class="fas fa-calendar-check text-sky-400 text-2xl"></i>
            </div>
            <h2 class="text-xl font-bold">Daily Review</h2>
            <div class="space-y-2 py-2">
                <p id="summary-time" class="text-slate-300 text-sm font-medium"></p>
                <p id="summary-sessions" class="text-slate-300 text-sm font-medium"></p>
            </div>
            <button onclick="closeSummary()" class="w-full py-3 bg-sky-600 rounded-xl font-bold text-sm hover:bg-sky-500 transition-colors">GOT IT</button>
        </div>
    </div>

    <div class="max-w-md mx-auto p-5 space-y-6">
        <header class="flex justify-between items-center py-6">
            <div>
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-sky-500 rounded-full animate-pulse"></div>
                    <h1 class="text-xl font-extrabold tracking-tight text-white">STUDY<span class="text-sky-500">PRO</span></h1>
                </div>
                <p class="text-[10px] text-slate-500 font-semibold uppercase tracking-[0.2em] mt-1">SSC 2026 Dashboard</p>
            </div>
            <div class="glass-card px-4 py-2 flex flex-col items-end border-l-4 border-sky-500">
                <div class="flex items-center gap-2">
                    <div class="text-right">
                        <p class="text-[8px] text-slate-500 uppercase font-bold">Today's Focus</p>
                        <span id="total-focus-display" class="text-xs font-black text-white">0h 0m</span>
                    </div>
                    <i class="fas fa-fire text-orange-500"></i>
                </div>
                <p id="streak-display" class="text-[9px] font-bold text-orange-400 mt-0.5 hidden"></p>
            </div>
        </header>

        <main id="app-main-content" class="relative z-10">
            <section id="timer" class="page-section active space-y-6">
                <div id="spotify-area" class="hidden">
                    <button onclick="handleSpotifyBreak()" class="w-full py-3.5 rounded-2xl bg-[#1DB954]/10 border border-[#1DB954]/30 text-[#1DB954] text-[10px] font-bold uppercase tracking-widest hover:bg-[#1DB954]/20 transition-all flex items-center justify-center gap-2">
                        <i class="fab fa-spotify text-lg"></i> ðŸŽ§ Relax during break with Spotify
                    </button>
                </div>

                <div class="glass-card p-10 text-center relative overflow-hidden premium-border">
                    <div class="relative z-10">
                        <div id="timer-label" class="inline-block px-4 py-1 rounded-full bg-slate-900/50 border border-slate-800 text-[10px] font-bold uppercase tracking-widest text-slate-400 mb-8">Focus Session</div>
                        <div class="relative w-56 h-56 mx-auto mb-10 flex items-center justify-center">
                            <svg class="w-full h-full transform -rotate-90">
                                <circle cx="112" cy="112" r="104" stroke="rgba(255,255,255,0.03)" stroke-width="4" fill="transparent" />
                                <circle id="timer-circle" cx="112" cy="112" r="104" stroke="url(#timer-gradient)" stroke-width="8" fill="transparent" stroke-dasharray="653.4" stroke-dashoffset="0" stroke-linecap="round" class="transition-all duration-1000" />
                                <defs>
                                    <linearGradient id="timer-gradient" x1="0%" y1="0%" x2="100%" y2="0%"><stop offset="0%" stop-color="#38bdf8" /><stop offset="100%" stop-color="#818cf8" /></linearGradient>
                                </defs>
                            </svg>
                            <div class="absolute inset-0 flex flex-col items-center justify-center">
                                <span id="timer-display" class="text-6xl font-black text-white tracking-tighter">25:00</span>
                            </div>
                        </div>
                        <div class="flex gap-4 justify-center items-center mb-6">
                            <button onclick="playClick(); resetTimer()" class="w-12 h-12 rounded-2xl bg-slate-900/50 border border-slate-800 text-slate-400 hover:text-white transition"><i class="fas fa-redo-alt"></i></button>
                            <button id="timer-btn" onclick="playClick(); toggleTimer()" class="h-16 px-10 rounded-3xl bg-sky-600 hover:bg-sky-500 text-white font-bold text-lg transition-all active:scale-95 uppercase tracking-wide">START</button>
                            <button id="mute-btn" onclick="toggleMute()" class="w-12 h-12 rounded-2xl bg-slate-900/50 border border-slate-800 text-slate-400 hover:text-white transition"><i id="mute-icon" class="fas fa-volume-up"></i></button>
                        </div>
                        <div id="feedback-area" class="h-6 flex items-center justify-center"><p id="feedback-text" class="text-[11px] font-semibold text-sky-400/80 tracking-wide opacity-0"></p></div>
                    </div>
                </div>

                <div id="break-status-msg" class="hidden glass-card px-5 py-4 border-l-4 border-emerald-500 bg-emerald-500/5">
                    <div class="flex items-center gap-3">
                        <i class="fas fa-coffee text-emerald-400"></i>
                        <span class="text-[10px] font-bold uppercase tracking-widest text-emerald-200">ðŸŽ§ Break Active â€” Enjoy Your Time</span>
                    </div>
                </div>
            </section>

            <section id="tasks" class="page-section space-y-4">
                <div class="flex justify-between items-center mb-2 px-1">
                    <h2 class="text-xl font-bold">Today's Missions</h2>
                    <button onclick="playClick(); toggleInput()" class="text-sky-500 text-[10px] font-bold uppercase tracking-widest flex items-center gap-2 bg-sky-500/10 px-3 py-1.5 rounded-lg border border-sky-500/20 active:scale-95 transition-all"><i class="fas fa-plus"></i> Add Mission</button>
                </div>
                <div id="input-container" class="hidden glass-card p-1.5 flex items-center gap-2 border border-sky-500/30 mb-4 transition-all duration-300">
                    <input id="task-input" type="text" placeholder="Mission name..." class="flex-1 bg-transparent border-none px-4 py-2 text-sm focus:outline-none text-white h-11">
                    <button onclick="playClick(); addTask()" class="w-11 h-11 bg-sky-600 rounded-xl flex items-center justify-center hover:bg-sky-500 transition-colors shrink-0 active:scale-95"><i class="fas fa-check text-white"></i></button>
                </div>
                <div id="task-list" class="space-y-3"></div>
            </section>

            <section id="stats" class="page-section">
                <div class="glass-card p-6 border-t-4 border-sky-500 space-y-6">
                    <div class="flex items-center justify-between"><h3 class="font-bold">Study Insights</h3><i class="fas fa-chart-line text-sky-500"></i></div>
                    <div class="space-y-2">
                        <div class="flex justify-between text-[10px] font-bold uppercase tracking-widest text-slate-400"><span>Mission Progress</span><span id="progress-percent">0%</span></div>
                        <div class="w-full h-3 bg-slate-900 rounded-full overflow-hidden border border-slate-800"><div id="progress-bar" class="h-full bg-gradient-to-r from-sky-500 to-blue-600 transition-all duration-700" style="width: 0%"></div></div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-4 bg-slate-900/50 rounded-2xl border border-slate-800"><p class="text-[10px] text-slate-500 font-bold uppercase mb-1">Sessions</p><p id="session-count" class="text-xl font-black">0</p></div>
                        <div class="p-4 bg-slate-900/50 rounded-2xl border border-slate-800"><p class="text-[10px] text-slate-500 font-bold uppercase mb-1">Status</p><p id="study-status" class="text-sm font-black text-sky-400 tracking-tight">Idle</p></div>
                    </div>
                </div>
            </section>
        </main>

        <div class="bottom-nav-container">
            <nav class="glass-card p-2 flex justify-around items-center border border-white/10 shadow-2xl">
                <button onclick="handleNavClick('tasks')" id="nav-tasks" class="nav-btn w-14 h-14 rounded-xl flex items-center justify-center text-slate-500 transition-all"><i class="fas fa-tasks text-lg"></i></button>
                <button onclick="handleNavClick('timer')" id="nav-timer" class="nav-btn nav-active w-14 h-14 rounded-xl flex items-center justify-center transition-all"><i class="fas fa-stopwatch text-lg"></i></button>
                <button onclick="handleNavClick('stats')" id="nav-stats" class="nav-btn w-14 h-14 rounded-xl flex items-center justify-center text-slate-500 transition-all"><i class="fas fa-chart-bar text-lg"></i></button>
            </nav>
        </div>
    </div>

    <script>
        let state = {
            tasks: JSON.parse(localStorage.getItem('ssc26_tasks')) || [],
            totalFocusedMinutes: Number(localStorage.getItem('ssc26_focused_min')) || 0,
            sessions: Number(localStorage.getItem('ssc26_sessions')) || 0,
            date: localStorage.getItem('ssc26_date') || new Date().toDateString(),
            isMuted: JSON.parse(localStorage.getItem('ssc26_muted')) || false,
            accumulatedSeconds: Number(localStorage.getItem('ssc26_acc_sec')) || 0,
            streak: Number(localStorage.getItem('ssc26_streak')) || 0,
            lastStreakDate: localStorage.getItem('ssc26_last_streak_date') || null,
            trialStartDate: localStorage.getItem('ssc26_trial_start') || Date.now()
        };

        let timerParams = JSON.parse(localStorage.getItem('ssc26_timer_params')) || {
            startTime: null, startDuration: 1500, isRunning: false, mode: 'study'
        };

        let lastTimestamp = Date.now();
        const SPOTIFY_URL = "https://open.spotify.com/playlist/37i9dQZF1DX4hpot8sYudB?si=qucJGF5yQH-4wkduTx6psQ";

        function saveState() {
            localStorage.setItem('ssc26_tasks', JSON.stringify(state.tasks));
            localStorage.setItem('ssc26_focused_min', state.totalFocusedMinutes);
            localStorage.setItem('ssc26_sessions', state.sessions);
            localStorage.setItem('ssc26_date', state.date);
            localStorage.setItem('ssc26_acc_sec', state.accumulatedSeconds);
            localStorage.setItem('ssc26_streak', state.streak);
            localStorage.setItem('ssc26_last_streak_date', state.lastStreakDate);
            localStorage.setItem('ssc26_trial_start', state.trialStartDate);
        }

        function saveTimerState() {
            localStorage.setItem('ssc26_timer_params', JSON.stringify(timerParams));
        }

        function checkTrialExpiry() {
            const sevenDaysInMs = 7 * 24 * 60 * 60 * 1000;
            const elapsed = Date.now() - Number(state.trialStartDate);
            if (elapsed > sevenDaysInMs) {
                document.getElementById('trial-modal').classList.remove('hidden');
                document.getElementById('app-main-content').classList.add('opacity-10', 'pointer-events-none');
                return true;
            }
            return false;
        }

        function checkDayTransition() {
            const todayStr = new Date().toDateString();
            if (state.date !== todayStr) {
                const prevMins = state.totalFocusedMinutes;
                const prevSessions = state.sessions;
                if (prevMins > 0 || prevSessions > 0) showSummary(prevMins, prevSessions);
                if (prevMins >= 10) updateStreak(todayStr);
                else {
                    const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
                    if (state.lastStreakDate !== yesterday.toDateString() && state.lastStreakDate !== todayStr) state.streak = 0;
                }
                state.totalFocusedMinutes = 0; state.sessions = 0; state.accumulatedSeconds = 0;
                state.date = todayStr; saveState();
            }
            updateStreakUI();
        }

        function updateStreak(todayStr) {
            const lastDate = state.lastStreakDate;
            if (lastDate === todayStr) return;
            const yesterday = new Date(); yesterday.setDate(yesterday.getDate() - 1);
            if (lastDate === yesterday.toDateString()) state.streak += 1;
            else if (!lastDate || state.streak === 0) state.streak = 1;
            state.lastStreakDate = todayStr; saveState(); updateStreakUI();
        }

        function updateStreakUI() {
            const el = document.getElementById('streak-display');
            if (state.streak > 0) { el.innerText = `ðŸ”¥ ${state.streak} day streak`; el.classList.remove('hidden'); }
            else el.classList.add('hidden');
        }

        function showSummary(mins, sessions) {
            const h = Math.floor(mins / 60), m = Math.floor(mins % 60);
            document.getElementById('summary-time').innerText = `Yesterday: ${h > 0 ? h + 'h ' : ''}${m}m studied`;
            document.getElementById('summary-sessions').innerText = `${sessions} focus sessions completed`;
            document.getElementById('summary-modal').classList.remove('hidden');
        }

        function closeSummary() { document.getElementById('summary-modal').classList.add('hidden'); }

        function playClick() { if (!state.isMuted) document.getElementById('click-sound')?.play().catch(()=>{}); }
        function playEndSound() { if (!state.isMuted) document.getElementById('end-sound')?.play().catch(()=>{}); }

        function toggleTimer() {
            if (timerParams.isRunning) {
                const elapsed = Math.floor((Date.now() - timerParams.startTime) / 1000);
                timerParams.startDuration = Math.max(0, timerParams.startDuration - elapsed);
                timerParams.isRunning = false;
                timerParams.startTime = null;
            } else {
                const currentLimit = timerParams.mode === 'study' ? 1500 : 300;
                if (timerParams.startDuration <= 0) timerParams.startDuration = currentLimit;
                timerParams.isRunning = true;
                timerParams.startTime = Date.now();
            }
            saveTimerState();
            updateUI();
        }

        function resetTimer() {
            timerParams.isRunning = false;
            timerParams.startTime = null;
            timerParams.startDuration = timerParams.mode === 'study' ? 1500 : 300;
            state.accumulatedSeconds = 0;
            saveTimerState();
            saveState();
            updateUI();
        }

        function completeSession() {
            playEndSound();
            timerParams.isRunning = false;
            timerParams.startTime = null;
            if (timerParams.mode === 'study') {
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                state.sessions++;
                timerParams.mode = 'break';
                timerParams.startDuration = 300;
            } else {
                timerParams.mode = 'study';
                timerParams.startDuration = 1500;
            }
            state.accumulatedSeconds = 0;
            saveState();
            saveTimerState();
            updateUI();
        }

        function handleSpotifyBreak() {
            playClick();
            timerParams.mode = 'break';
            timerParams.startDuration = 300;
            timerParams.isRunning = true;
            timerParams.startTime = Date.now();
            state.accumulatedSeconds = 0;
            window.open(SPOTIFY_URL, '_blank');
            saveTimerState();
            saveState();
            updateUI();
        }

        function updateUI() {
            const now = Date.now();
            const deltaSec = Math.min((now - lastTimestamp) / 1000, 2);
            lastTimestamp = now;

            let currentSecondsLeft = timerParams.startDuration;

            if (timerParams.isRunning && timerParams.startTime) {
                const elapsed = Math.floor((now - timerParams.startTime) / 1000);
                currentSecondsLeft = Math.max(0, timerParams.startDuration - elapsed);

                if (timerParams.mode === 'study') {
                    state.accumulatedSeconds += deltaSec;
                    if (state.accumulatedSeconds >= 60) {
                        const minsToAdd = Math.floor(state.accumulatedSeconds / 60);
                        state.totalFocusedMinutes += minsToAdd;
                        state.accumulatedSeconds -= (minsToAdd * 60);
                        if (state.totalFocusedMinutes >= 10) updateStreak(new Date().toDateString());
                        saveState();
                    }
                }

                if (currentSecondsLeft <= 0) {
                    completeSession();
                    return;
                }
            }

            const m = Math.floor(currentSecondsLeft / 60), s = Math.floor(currentSecondsLeft % 60);
            document.getElementById('timer-display').innerText = `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
            const max = timerParams.mode === 'study' ? 1500 : 300;
            document.getElementById('timer-circle').style.strokeDashoffset = 653.4 - (currentSecondsLeft / max) * 653.4;
            document.getElementById('total-focus-display').innerText = `${Math.floor(state.totalFocusedMinutes / 60)}h ${Math.floor(state.totalFocusedMinutes % 60)}m`;
            document.getElementById('session-count').innerText = state.sessions;
            document.getElementById('study-status').innerText = timerParams.isRunning ? (timerParams.mode === 'study' ? 'Studying' : 'On Break') : 'Idle';
            document.getElementById('timer-label').innerText = timerParams.mode === 'study' ? "Focus Session" : "Short Break";
            
            const btn = document.getElementById('timer-btn');
            if (!timerParams.isRunning) {
                if (currentSecondsLeft <= 0) {
                    btn.innerText = timerParams.mode === 'study' ? 'START BREAK' : 'START STUDY';
                } else {
                    btn.innerText = (currentSecondsLeft === max) ? 'START' : 'RESUME';
                }
                btn.classList.replace('bg-rose-600', 'bg-sky-600');
            } else {
                btn.innerText = 'PAUSE';
                btn.classList.replace('bg-sky-600', 'bg-rose-600');
            }

            document.getElementById('spotify-area').classList.toggle('hidden', timerParams.mode !== 'break');
            document.getElementById('break-status-msg').classList.toggle('hidden', timerParams.mode !== 'break');
            
            if(state.tasks.length > 0) {
                const percent = Math.round((state.tasks.filter(t => t.done).length / state.tasks.length) * 100);
                document.getElementById('progress-bar').style.width = percent + '%';
                document.getElementById('progress-percent').innerText = percent + '%';
            }
        }

        function handleNavClick(id) { playClick(); showSection(id); }
        function showSection(id) {
            document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('nav-active'));
            document.getElementById(id).classList.add('active');
            document.getElementById(`nav-${id}`).classList.add('nav-active');
            if(id === 'tasks') renderTasks();
        }

        function toggleMute() { state.isMuted = !state.isMuted; localStorage.setItem('ssc26_muted', state.isMuted); updateMuteUI(); }
        function updateMuteUI() { document.getElementById('mute-icon').className = state.isMuted ? 'fas fa-volume-mute' : 'fas fa-volume-up'; }
        function toggleInput() { document.getElementById('input-container').classList.toggle('hidden'); }
        function addTask() {
            const v = document.getElementById('task-input').value.trim();
            if(v) { state.tasks.push({id:Date.now(), text:v, done:false}); document.getElementById('task-input').value=''; toggleInput(); saveState(); renderTasks(); updateUI(); }
        }
        function toggleTask(id) { state.tasks = state.tasks.map(t => t.id === id ? {...t, done: !t.done} : t); saveState(); renderTasks(); updateUI(); }
        function deleteTask(id) { state.tasks = state.tasks.filter(t => t.id !== id); saveState(); renderTasks(); updateUI(); }
        function renderTasks() {
            const l = document.getElementById('task-list');
            if (!state.tasks.length) { l.innerHTML = `<p class="text-center py-10 text-slate-600 text-[10px] uppercase">No missions</p>`; return; }
            l.innerHTML = state.tasks.map(t => `
                <div class="glass-card p-4 flex items-center justify-between group">
                    <div class="flex items-center gap-3">
                        <button onclick="toggleTask(${t.id})" class="w-6 h-6 rounded-lg border-2 flex items-center justify-center ${t.done ? 'bg-sky-500 border-sky-500' : 'border-slate-700'}">${t.done ? '<i class="fas fa-check text-[10px]"></i>' : ''}</button>
                        <span class="text-sm ${t.done ? 'line-through text-slate-600' : 'text-slate-200'}">${t.text}</span>
                    </div>
                    <button onclick="deleteTask(${t.id})" class="text-slate-700 hover:text-rose-500"><i class="fas fa-trash-alt"></i></button>
                </div>
            `).join('');
        }

        window.onload = () => {
            if (checkTrialExpiry()) return;
            checkDayTransition();
            lastTimestamp = Date.now();
            setInterval(updateUI, 1000);
            updateMuteUI(); renderTasks(); updateUI();
        };
    </script>
</body>
</html>

